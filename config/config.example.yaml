# Seniorenradio Configuration
# Copy this file to ./config/config.yaml and customize

# Audio output settings
audio:
  # Audio backend: "alsa" or "pipewire"
  backend: "pipewire"
  # Audio device (ALSA only): "default" for auto-detect, or specific device like "hw:1,0" or "plughw:1,0"
  # Ignored when backend is "pipewire". Use `aplay -l` to list available ALSA devices
  device: "default"
  # Volume level (0-100)
  volume: 80
  # Stream buffering options (for stability on unreliable networks)
  buffer:
    enabled: true
    # Cache seconds kept in memory
    cache_seconds: 8
    # Maximum demuxer buffer size
    demuxer_max_bytes: "32MiB"
    # Network timeout in seconds
    network_timeout_seconds: 10

# GPIO pin configuration (BCM numbering)
gpio:
  # Pins for channel buttons (1-5)
  channel_pins: [17, 22, 23, 24, 25]
  # Pin for start/stop selector switch
  switch_pin: 27
  # Software debounce time in milliseconds
  debounce_ms: 200
  # Invert selector switch behavior (swap ON/OFF positions)
  # Set to true if your switch wiring causes opposite behavior
  invert_switch: false

# Stream retry settings
retry:
  # Number of connection attempts before giving up
  max_attempts: 3
  # Delay between retry attempts in seconds
  delay_seconds: 7

# Stream watchdog settings (detect dropouts and reconnect)
watchdog:
  enabled: true
  # How often to check stream health
  check_interval_seconds: 2
  # Treat stream as stalled if playback time does not progress
  stall_seconds: 8
  # Delay before trying another reconnect attempt
  reconnect_delay_seconds: 2
  # Light internet check before reconnecting
  internet_check_enabled: true
  # Hosts to probe for internet connectivity
  internet_check_hosts: ["1.1.1.1", "8.8.8.8"]
  internet_check_port: 53
  internet_check_timeout_seconds: 2

# WiFi management (NetworkManager)
wifi:
  nmcli_path: "nmcli"
  command_timeout_seconds: 5
  connect_timeout_seconds: 20

# Text-to-speech for debug readouts
tts:
  enabled: true
  # TTS engine binary
  engine: "espeak-ng"
  # Voice (null = default)
  voice: null
  # Speech rate (words per minute for espeak-ng)
  rate: 120
  # Volume (0-200 for espeak-ng)
  volume: 100

# Debug readout behavior (triggered via long-press on Channel 2)
debug:
  enabled: false
  long_press_seconds: 4
  selection_timeout_seconds: 12
  max_networks: 5
  # Stop stream audio while speaking diagnostics
  interrupt_audio: true

# Directory containing announcement audio files (relative to this config file)
audio_dir: "../audio"

# Error announcement audio files (relative to audio_dir)
# These are played when the stream connection fails
error_announcements:
  # Played when retrying connection
  retrying: "error_retrying.mp3"
  # Played when all retries have failed
  failed: "error_failed.mp3"
  # Played when there is no internet connection
  no_internet: "error_no_internet.mp3"

# Boot connectivity announcements (relative to audio_dir)
boot_announcements:
  # Played when internet is available
  connected: "boot_connected.mp3"
  # Played when internet is not available
  no_internet: "boot_no_internet.mp3"

# Radio channels (up to 5)
# Each channel needs:
#   - name: Display name (used for logging)
#   - stream_url: URL of the MP3/AAC stream
#   - announcement_file: Filename of the audio announcement (relative to audio_dir)
channels:
  - name: "SWR1 Baden-Württemberg"
    stream_url: "https://liveradio.swr.de/sw282p3/swr1bw/"
    announcement_file: "channel_1.mp3"

  - name: "SWR2"
    stream_url: "https://liveradio.swr.de/sw282p3/swr2/"
    announcement_file: "channel_2.mp3"

  - name: "SWR3"
    stream_url: "https://liveradio.swr.de/sw282p3/swr3/"
    announcement_file: "channel_3.mp3"

  - name: "SWR4 Baden-Württemberg"
    stream_url: "https://liveradio.swr.de/sw282p3/swr4bw/"
    announcement_file: "channel_4.mp3"

  - name: "SWR Aktuell"
    stream_url: "https://liveradio.swr.de/sw282p3/swraktuell/"
    announcement_file: "channel_5.mp3"

# Default channel to play on startup (0-based index)
default_channel: 0

# Goodbye announcement when radio is turned off
# German example: "Auf Wiederhören."
goodbye_announcement: "goodbye.mp3"
